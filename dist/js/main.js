"use strict";window.addEventListener("load",function(){"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js").catch(function(e){console.log("Service worker registration failed:",e)})});var restaurants=void 0,neighborhoods=void 0,cuisines=void 0,observer=void 0,map=void 0,markers=[];document.addEventListener("DOMContentLoaded",function(){DBHelper.fetchNeighborhoodsFromCache(handleNeighborhoods).then(function(){fetchNeighborhoods()}),DBHelper.fetchCuisinesFromCache(handleCuisines).then(function(){fetchCuisines()}),DBHelper.fetchRestaurantsFromCache(handlerCuisineAndNeighborhod)}),observer=new IntersectionObserver(function(e){var t=!0,n=!1,r=void 0;try{for(var a,o=e[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){var i=a.value;if(!i.isIntersecting)return;var s=i.target.childNodes,d=!0,c=!1,l=void 0;try{for(var u,h=s[Symbol.iterator]();!(d=(u=h.next()).done);d=!0){var f=u.value;f.setAttribute("srcset",f.getAttribute("data-srcset")),"IMG"===f.tagName&&f.setAttribute("src",f.getAttribute("data-src"))}}catch(e){c=!0,l=e}finally{try{!d&&h.return&&h.return()}finally{if(c)throw l}}observer.unobserve(i.target)}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}});var fetchNeighborhoods=function(){DBHelper.fetchNeighborhoods(handleNeighborhoods)},handleNeighborhoods=function(e,t){e?console.error(e):(self.neighborhoods=t,fillNeighborhoodsHTML(t))},fillNeighborhoodsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.neighborhoods,n=document.getElementById("neighborhoods-select");e.forEach(function(e){var t=document.createElement("option");t.innerHTML=e,t.value=e,t.name=e,n.append(t)})},fetchCuisines=function(){DBHelper.fetchCuisines(handleCuisines)},handleCuisines=function(e,t){e?console.error(e):(self.cuisines=t,fillCuisinesHTML())},fillCuisinesHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.cuisines,n=document.getElementById("cuisines-select");e.forEach(function(e){var t=document.createElement("option");t.innerHTML=e,t.value=e,n.append(t)})};window.initMap=function(){self.map=new google.maps.Map(document.getElementById("map"),{zoom:12,center:{lat:40.722216,lng:-73.987501},scrollwheel:!1,keyboardShortcuts:!1})},window.showMap=function(){requestAnimationFrame(function(){var e=document.getElementById("map-container");e.classList.remove("hidden"),e.classList.add("active"),addMarkersToMap(restaurants)})};var handlerCuisineAndNeighborhod=function(e,t){e?console.error(e):(resetRestaurants(t),fillRestaurantsHTML())},updateRestaurants=function(){var e=document.getElementById("cuisines-select"),t=document.getElementById("neighborhoods-select"),n=e.selectedIndex,r=t.selectedIndex,a=e[n].value,o=t[r].value;DBHelper.fetchRestaurantByCuisineAndNeighborhood(a,o,handlerCuisineAndNeighborhod)},resetRestaurants=function(e){self.restaurants=[],document.getElementById("restaurants-list").innerHTML="",self.markers.forEach(function(e){return e.setMap(null)}),self.markers=[],self.restaurants=e},fillRestaurantsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurants,t=document.getElementById("restaurants-list");e.forEach(function(e){t.append(createRestaurantHTML(e))})},createRestaurantHTML=function(t){var e=document.createElement("li"),n=document.createElement("picture");DBHelper.getSourcesForRestaurant(t).map(function(e){e.setAttribute("alt","Picture of "+t.name+" restaurant"),n.append(e)}),n.className="restaurant-img",e.append(n),observer.observe(n);var r=document.createElement("div");r.className="restaurant-info";var a=document.createElement("h3");a.innerHTML=t.name,a.id="restaurant-item-"+t.id,r.append(a);var o=document.createElement("p");o.innerHTML=t.neighborhood,r.append(o);var i=document.createElement("p");i.innerHTML=t.address,r.append(i);var s=document.createElement("a");s.innerHTML="View Details",s.href=DBHelper.urlForRestaurant(t),s.setAttribute("aria-labelledby","restaurant-detail-"+t.id),r.append(s);var d=document.createElement("span");return d.hidden=!0,d.id="restaurant-detail-"+t.id,d.innerHTML="Restaurant name: "+t.name+", address:"+t.address+", click the link to view detail",e.appendChild(d),e.append(r),e},addMarkersToMap=function(){(0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurants).forEach(function(e){var t=DBHelper.mapMarkerForRestaurant(e,self.map);google.maps.event.addListener(t,"click",function(){window.location.href=t.url}),self.markers.push(t)})};
//# sourceMappingURL=main.js.map
